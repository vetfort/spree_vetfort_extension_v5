<div
  class="fixed end-1 bottom-1 group flex flex-col items-end z-[100]"
  data-controller="ai-chat"
>
    <div
      class="flex flex-col items-center hidden space-y-2 shadow-md"
      data-ai-chat-target="dialog"
    >
      <%= turbo_frame_tag "vetfort-ai-chat", data: { action: "turbo:frame-load->ai-chat#scrollToBottom" } do %>
         <%= turbo_stream_from "ai_consultant:#{current_user ? "user:#{current_user.id}" : "guest:#{cookies.signed[:vetfort_guest_uuid]}"}" %>
         <div class="w-screen">
          <div class="bg-purple-200 shadow rounded-lg overflow-hidden flex flex-col min-h-0" style="height: 60vh;">
            <div id="ai-scroll" class="p-3 h-full overflow-y-auto" role="log" aria-live="polite" aria-relevant="additions" data-ai-chat-target="scroll">
              <div id="ai-messages" class="min-h-full flex flex-col justify-end gap-3" data-ai-chat-target="messages"></div>
            </div>
            <%= render 'spree/ai_consultant/chat_form' %>

            <!-- Templates for client-side message rendering using the same partials -->
            <template id="ai-chat-message-user">
              <%= render 'spree/ai_consultant/customer_message', text: '', time: '' %>
            </template>
          </div>
        </div>
      <% end %>
    </div>
    <%= render 'spree/ai_consultant/bot_button' %>
</div>
